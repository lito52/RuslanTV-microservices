generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

model Channel {
  id     String @id @default(uuid())
  userId String @unique
  name   String
  handle String @unique
  bio    String

  profilePicture    String
  backgroundPicture String

  posts                Post[]
  subcriptions         Subscriptions[]
  playlist             Playlist[]
  postComments         PostComments[]
  postCommentReactions PostCommentReactions[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("channels")
}

model Subscriptions {
  id String @id @default(uuid())

  userId String

  channel   Channel @relation(fields: [channelId], references: [id])
  channelId String

  subscribeType SubscribeType @default(REGULAR)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@unique([userId, channelId])
  @@index([userId])
  @@index([channelId])
  @@map("subscriptions")
}

model Post {
  id String @id @default(uuid())

  title String

  description String

  picture String

  postLikes    PostLikes[]
  postComments PostComments[]

  channelId String
  channel   Channel @relation(fields: [channelId], references: [id])

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([channelId])
  @@map("posts")
}

model PostLikes {
  id String @id @default(uuid())

  postId String
  post   Post   @relation(fields: [postId], references: [id], onDelete: Cascade)

  channelId String

  reaction ReactionValue

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@unique([postId, channelId])
  @@map("post_likes")
}

model PostComments {
  id String @id @default(uuid())

  postId String
  post   Post   @relation(fields: [postId], references: [id], onDelete: Cascade)

  channelId String
  channel   Channel @relation(fields: [channelId], references: [id])

  postCommentReactions PostCommentReactions[]

  text String

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@unique([postId, channelId])
  @@map("post_comments")
}

model PostCommentReactions {
  id String @id @default(uuid())

  commentId    String
  postComments PostComments @relation(fields: [commentId], references: [id], onDelete: Cascade)

  channelId String
  channel   Channel @relation(fields: [channelId], references: [id])

  reaction ReactionValue

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@unique([commentId, channelId])
  @@map("post_comment_reactions")
}

model Playlist {
  id String @id @default(uuid())

  title       String
  description String

  channelId String
  channel   Channel @relation(fields: [channelId], references: [id])

  playlistVideo PlaylistVideo[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("playlists")
}

model PlaylistVideo {
  id String @id @default(uuid())

  playlistId String
  playlist   Playlist @relation(fields: [playlistId], references: [id], onDelete: Cascade)

  videoId String

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("playlist_videos")
}

enum ReactionValue {
  LIKE
  DISLIKE
}

enum SubscribeType {
  REGULAR
  NOTIFICATIONS
}
